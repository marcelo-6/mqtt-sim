{
  "schema_version": 1,
  "brokers": [
    {
      "name": "main",
      "host": "localhost",
      "port": 1883
    }
  ],
  "streams": [
    {
      "name": "smart_plug_coffee_corner",
      "broker": "main",
      "topic": "smart-home/energy/smart-plug/coffee-corner",
      "interval": 1.0,
      "payload": {
        "kind": "json_fields",
        "fields": [
          {"name": "on", "generator": {"kind": "bool_toggle", "start": true}},
          {
            "name": "power_w",
            "generator": {
              "kind": "number_random",
              "numeric_type": "int",
              "min": 0,
              "max": 1800
            }
          },
          {
            "name": "energy_wh",
            "generator": {
              "kind": "expression",
              "expression": "(prev or 0) + randint(0, 25)"
            }
          }
        ]
      }
    },
    {
      "name": "ev_charger",
      "broker": "main",
      "topic": "smart-home/energy/ev-charger/state",
      "interval": 2.0,
      "retain": true,
      "payload": {
        "kind": "json_fields",
        "fields": [
          {
            "name": "status",
            "generator": {
              "kind": "choice",
              "values": ["idle", "charging", "scheduled", "complete"]
            }
          },
          {
            "name": "current_a",
            "generator": {
              "kind": "number_walk",
              "numeric_type": "int",
              "min": 0,
              "max": 32,
              "step": 8,
              "start": 16
            }
          },
          {
            "name": "session_kwh",
            "generator": {
              "kind": "expression",
              "expression": "(prev or 0) + uniform(0, 0.4)"
            }
          }
        ]
      }
    },
    {
      "name": "solar_inverter",
      "broker": "main",
      "topic": "smart-home/energy/solar-inverter/output",
      "interval": 1.3,
      "payload": {
        "kind": "json_fields",
        "fields": [
          {
            "name": "pv_power_w",
            "generator": {
              "kind": "expression",
              "expression": "2500 + 1200 * math.sin(count / 4)"
            }
          },
          {
            "name": "grid_export_w",
            "generator": {
              "kind": "number_random",
              "numeric_type": "int",
              "min": 0,
              "max": 1500
            }
          }
        ]
      }
    },
    {
      "name": "home_battery",
      "broker": "main",
      "topic": "smart-home/energy/home-battery/state",
      "interval": 1.8,
      "retain": true,
      "payload": {
        "kind": "json_fields",
        "fields": [
          {
            "name": "soc_pct",
            "generator": {
              "kind": "number_walk",
              "numeric_type": "int",
              "min": 20,
              "max": 95,
              "step": 3,
              "start": 55
            }
          },
          {
            "name": "mode",
            "generator": {
              "kind": "choice",
              "values": ["charge", "discharge", "standby"]
            }
          },
          {
            "name": "power_w",
            "generator": {
              "kind": "number_random",
              "numeric_type": "int",
              "min": -3000,
              "max": 3000
            }
          }
        ]
      }
    },
    {
      "name": "grid_meter",
      "broker": "main",
      "topic": "smart-home/energy/grid-meter/summary",
      "interval": 2.2,
      "payload": {
        "kind": "json_fields",
        "fields": [
          {
            "name": "import_w",
            "generator": {
              "kind": "number_random",
              "numeric_type": "int",
              "min": 0,
              "max": 4500
            }
          },
          {
            "name": "export_w",
            "generator": {
              "kind": "number_random",
              "numeric_type": "int",
              "min": 0,
              "max": 2500
            }
          },
          {
            "name": "tariff",
            "generator": {
              "kind": "choice",
              "values": ["off_peak", "mid_peak", "on_peak"]
            }
          }
        ]
      }
    }
  ]
}
